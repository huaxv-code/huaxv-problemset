# 01 背包变换解法

??? question "[问题描述](https://www.luogu.com.cn/problem/T313940?contestId=101142)"

    有 $n$ 件物品和容量大小为 $m$ 的背包，注意背包的容量 $1 \leq m \leq 10 ^ 9$ 特别大！

    每一件物品都有其一定的体积 $w_i$ 和价值 $v_i$.

    问该背包怎么装才能使得价值最大化.

    **数据范围**

    $1 \leq n \leq 100$

    $1 \leq m \leq 10 ^ 9$

    $1 \leq w_i \leq m$

    $1 \leq v_i \leq 10 ^ 3$

    **输入输出**

    【输入描述】

    第一行输入两个整数分别代表 $n、m$

    接下来的 $n$ 行，每行两个整数，分别代表 $w_i、v_i$

    【输出描述】

    输出只有一个整数，代表结果

    **样例一**

    输入：

    ```
    6 15
    6 5
    5 6
    6 4
    6 6
    3 5
    7 2
    ```

    输出：

    ```
    17
    ```

## 01 背包变换解法

通常的 *01 背包* 解法是定义 $dp[i][j]$ 为用了前 $i$ 件物品且背包体积为 $j$ 时的最大价值，那么状态跃迁方程为：$dp[i][j] = max(dp[i - 1][j], dp[i - 1][j - w_i] + v_i)$

对于这一题来说，背包容量可以达到惊人的 $10 ^ 9$ !

使用这个的解法的时间复杂度到达惊人的 $O(10 ^ 11)$ 空间复杂度到达 $O(10 ^ 11)$

都不符合规则.

---

我们发现最大价值是有上界的，即最大不超过 $10 ^ 5$ 

那么我们是否可以遍历每一个价值，遍历的问题是组成这个价值，需要多少的体积，当然，体积要越小越好，这样才更有可能装入背包当中

定义 $dp[i][j]$ 为使用前 $i$ 个物品组合成价值为 $j$ 时所需要用到的最少体积，那么对于第 $i$ 件物品来说，到底是选还是不选有两种状态，如果不选，那么 $dp[i][j] = dp[i - 1][j]$ 如果选，那么 $dp[i][j] = dp[i - 1][j - v_i] + w_i$ 两者取最小.

时间复杂度：$O(10 ^ 7)$

??? success "代码参考"

    ```c++
    LL n, m;
    LL dp[N], w[N], v[N], res;

    void solve(void)
    {
        // 最大总钱数不超过 1e5，
        // 那么我们就获取对于组合到 x 那么多钱的情况下
        // 所需要的最少体积是多少
        for (LL i = 0; i <= 100010; i ++)
            dp[i] = 1e18;
        dp[0] = 0;
        n = gll(), m = gll();
        for (LL i = 1; i <= n; i ++)
            w[i] = gll(), v[i] = gll();
        for (LL i = 1; i <= n; i ++)
        {
            for (LL j = 100010; j; j --)
            {
                if (j - v[i] >= 0) dp[j] = min(dp[j], dp[j - v[i]] + w[i]);
            }
        }

        for (LL i = 0; i <= 100010; i ++)
            if (dp[i] <= m)
                res = max(res, i);
        pll(res);
    }
    ```