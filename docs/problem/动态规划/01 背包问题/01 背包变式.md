# 01 背包变式

??? question "[问题描述](https://atcoder.jp/contests/abc060/tasks/arc073_b)"

    给定 $n$ 个物品，和一个最多只能承载 $m$ 重量的背包.

    对于每一个物品都有自己的重量 $w_i$ 和价值 $v_i$.

    问背包的最大价值是多少？

    与 **01 背包问题** 差异的地方就在数据点处：

    $1 \leq n \leq 100$

    $1 \leq m, w_i \leq 10 ^ 9$

    for each i in [2, 3, ···, n]
        $w_1 \leq w_i \leq w_1 + 3$

    $1 \leq v_i \leq 10 ^ 7$

## 线性 dp

我们可以发现这 $n$ 件物品的重量距离第一个物品的重量差最多不超过 $3$.

我们定义 $dp[i][j][k]$ 表示为将前 $i$ 件物品选取其中的 $k$ 件装进背包里面时，相对重量的和为 $j$ 时的最优解，

对于第 $i$ 件物品到底是选还是不选呢？

如果不选，那么 $dp[i][j][k] = dp[i - 1][j][k]$

如果要选，那么 $dp[i][j][k] = dp[i - 1][j - w[i]][k - 1] + v[i]$

所以最优解： $dp[i][j][k] = max(dp[i - 1][j][k], dp[i - 1][j - w[i]][k - 1] + v[i])$

??? success "代码参考"

    ```c++
    LL n, m, rs;
    LL w[N], v[N];
    // 个数，相对容量，所选个数
    LL dp[110][330][110];

    void solve(void)
    {
        n = gll(), m = gll();
        for (LL i = 1; i <= n; i ++)
            w[i] = gll(), v[i] = gll();

        w[0] = w[1];

        for (LL i = 1; i <= n; i ++)
            w[i] -= w[0];

        dp[1][0][1] = v[1];
        for (LL i = 1; i < 330; i ++)
            dp[1][i][1] = v[1];

        for (LL i = 1; i <= n; i ++)
        {
            for (LL j = 0; j < 330; j ++)
            {
                for (LL k = 1; k <= i; k ++)
                {
                    dp[i][j][k] = dp[i - 1][j][k];
                    if (j - w[i] >= 0)
                        dp[i][j][k] = max(
                            dp[i][j][k],
                            dp[i - 1][j - w[i]][k - 1] + v[i]
                        );
                }
            }
        }

        for (LL i = 0; i < 330; i ++)
        {
            for (LL k = 1; k <= n; k ++)
                if (i + k * w[0] <= m)
                    rs = max(rs, dp[n][i][k]);
        }

        pll(rs);
    }
    ```