# 有依赖的背包

??? question "[问题描述](https://www.luogu.com.cn/problem/P1064)"

    金明有 $n$ 元钱，想要买 $m$ 个物品，第 $i$ 个物品的价格为 $w_i$，重要度为 $p_i$，从属的主件为 $q_i$.

    有些物品是从属于某个主件物品的附件，要购买这个物品就必须购买主件物品.

    我们的目标就是要让所有购买的物品 $w_i \times p_i$ 之和最大！

    **数据范围**

    $1 \leq n \leq 3.4 \times 10 ^ 4$

    $1 \leq m \leq 60$

    $0 \leq w_i \leq 10 ^ 4$

    $1 \leq p_i \leq 5$

    $0 \leq q_i \leq m$

    如果 $q_i = 0$ 什么该物品的主件就是他本身.

    **输入输出**

    【输入格式】

    第一行输入两个整数 $n$、$m$

    接下来的 $m$ 行，每行 $3$ 个整数，分别代表 $w_i、p_i、q_i$

    【输出格式】

    只输出一个整数代表答案.

    **样例一**

    输入：

    ```
    1000 5
    800 2 0
    400 5 1
    300 5 1
    400 3 0
    500 2 0
    ```

    输出：

    ```
    2200
    ```

## 有依赖的背包问题

如果购买了附件，就一定要连带着购买主件，但是购买主件却可以不用购买附件！

那么我怎么知道我有没有选上附件呢？

*要么只买主件，要么就买主件和附件，看一下哪个更好，就转为了分组背包的问题.*