# [概率最大的路径](https://leetcode.cn/problems/path-with-maximum-probability/)

=== "暴力跑 dfs"

    超时，遍历所有从 st 出发的路径

    ```java
    class Solution {
        int N = 100000;
        double ep = 0.00001;

        int[] g = new int[N];
        int[] e = new int[N];
        int[] ne = new int[N];
        double[] d = new double[N];
        int[] on = new int[N];
        int cur;

        int n;
        int st, ed;
        double res = 0.0;

        void add(int a, int b, double c) {
            cur ++;
            e[cur] = b;
            d[cur] = c;
            ne[cur] = g[a];
            g[a] = cur;
        }

        void dfs(int pt, double sm) {
            if (pt == 0) return;
            if (pt == ed) {
                res = Math.max(res, sm);
                return;
            }
            if (on[pt] > 0) return;

            on[pt] = 1;

            for (int i = g[pt]; i > 0; i = ne[i]) {
                dfs(e[i], sm * d[i]);
            }

            on[pt] = 0;
        }

        public double maxProbability(int ns, int[][] edges, double[] succProb, int start, int end) {
            n = ns;
            st = start + 1;
            ed = end + 1;

            for (int i = 0; i < edges.length; i ++) {
                add(edges[i][0] + 1, edges[i][1] + 1, succProb[i]);
                add(edges[i][1] + 1, edges[i][0] + 1, succProb[i]);
            }

            dfs(st, 1);

            return res;
        }
    }
    ```