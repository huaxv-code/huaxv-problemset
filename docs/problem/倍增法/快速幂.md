# 快速幂

??? question "[问题描述](https://www.luogu.com.cn/problem/P1226)"

    # 【模板】快速幂||取余运算

    ## 题目描述

    给你三个整数 $a,b,p$，求 $a^b \bmod p$。

    ## 输入格式

    输入只有一行三个整数，分别代表 $a,b,p$。

    ## 输出格式

    输出一行一个字符串 `a^b mod p=s`，其中 $a,b,p$ 分别为题目给定的值， $s$ 为运算结果。

    ## 样例 #1

    ### 样例输入 #1

    ```
    2 10 9
    ```

    ### 样例输出 #1

    ```
    2^10 mod 9=7
    ```

    ## 提示

    **样例解释**

    $2^{10} = 1024$，$1024 \bmod 9 = 7$。

    **数据规模与约定**

    对于 $100\%$ 的数据，保证 $0\le a,b < 2^{31}$，$a+b>0$，$2 \leq p \lt 2^{31}$。

## 倍增法

与二分法相反的倍增思想：

- 二分是不断的平分，减半，从大区间或者大范围不断分成小区间小范围，从而缩小答案区间.
- 倍增是不断的翻倍，从小区间不断倍增到大区间，从而整理出大区间的某些特征，求解区间查询有关的问题.

快速幂也是一种倍增的思想：

> $1245 = 10011011101_b = 2 ^ {10} + 2 ^ 7 + 2 ^ 6 + 2 ^ 4 + 2 ^ 3 + 2 ^ 2 + 2 ^ 0$
>
> 所以有：
>
> $19 ^ {1245} = 19 ^ {2 ^ {10} + 2 ^ 7 + 2 ^ 6 + 2 ^ 4 + 2 ^ 3 + 2 ^ 2 + 2 ^ 0}$
>
> 且 $19 ^ {2 ^ {i + 1}} = 19 ^ {2 ^ i} * 19 ^ {2 ^ i}$

不断的平方倍增上去.

??? success "代码参考"

    ```c++
    HH a, b, p;

    HH qpow(HH a, HH b, HH p)
    {
        if (b == 0) return 1;
        LL res = qpow(a, b / 2, p);
        res = res * res; res %= p;
        if (b & 1) res *= a, res %= p;
        return res;
    }

    void solve(void)
    {
        a = ghh(), b = ghh(), p = ghh();
        phh(a); cout << "^"; phh(b); cout << " mod "; phh(p); cout << "="; phh(qpow(a, b, p)); cout << endl;
    }
    ```
